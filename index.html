<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KidzFun Games - 18 Amazing Games!</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            font-family: 'Times New Roman', Times, serif; 
            background: linear-gradient(270deg, #ff6b6b, #4ecdc4, #45b7d1, #f093fb, #667eea, #764ba2); 
            background-size: 1200% 1200%; 
            min-height: 100vh; 
            animation: rainbowGradient 15s ease infinite; 
        }
        @keyframes rainbowGradient { 0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes floatUp { from { bottom: -100px; opacity: 1; } to { bottom: 110%; opacity: 0; } }
        
        .login-container { display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }
        .login-box { background: rgba(255,255,255,0.95); border-radius: 40px; padding: 40px; max-width: 450px; width: 100%; box-shadow: 0 30px 90px rgba(0,0,0,0.3); animation: slideUp 0.8s; }
        .login-logo { text-align: center; font-size: 4em; margin-bottom: 20px; animation: bounce 2s infinite; }
        .login-title { text-align: center; font-size: 2.5em; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px; font-weight: bold; }
        .login-subtitle { text-align: center; color: #666; margin-bottom: 30px; font-size: 1.1em; }
        .input-group { margin-bottom: 20px; }
        .input-label { display: block; margin-bottom: 8px; color: #667eea; font-weight: bold; font-size: 1.1em; }
        .input-field { width: 100%; padding: 15px 20px; border: 3px solid #e0e0e0; border-radius: 20px; font-size: 1.1em; font-family: 'Times New Roman', Times, serif; transition: all 0.3s; }
        .input-field:focus { outline: none; border-color: #667eea; box-shadow: 0 0 20px rgba(102,126,234,0.3); }
        .login-btn { width: 100%; background: linear-gradient(135deg, #f093fb, #f5576c); color: white; border: none; padding: 18px; font-size: 1.4em; border-radius: 25px; cursor: pointer; font-weight: bold; box-shadow: 0 10px 30px rgba(245,87,108,0.5); transition: all 0.3s; font-family: 'Times New Roman', Times, serif; }
        .login-btn:hover { transform: translateY(-3px); box-shadow: 0 15px 40px rgba(245,87,108,0.7); }
        .welcome-text { text-align: center; margin-top: 20px; color: #667eea; font-size: 1em; }
        
        .container { max-width: 1600px; margin: 0 auto; padding: 20px; display: none; }
        .container.active { display: block; }
        header { text-align: center; padding: 40px; background: rgba(255,255,255,0.15); backdrop-filter: blur(15px); border-radius: 40px; margin-bottom: 40px; box-shadow: 0 15px 50px rgba(0,0,0,0.3); }
        h1 { font-size: 4em; color: white; text-shadow: 0 0 20px rgba(255,255,255,0.8); margin-bottom: 15px; }
        .subtitle { font-size: 1.8em; color: #fff; text-shadow: 0 0 20px rgba(255,255,255,0.8); }
        
        .user-info { position: fixed; top: 10px; left: 10px; background: rgba(255,255,255,0.3); backdrop-filter: blur(10px); padding: 15px 20px; border-radius: 20px; color: white; font-weight: bold; z-index: 999; box-shadow: 0 10px 30px rgba(0,0,0,0.3); display: none; }
        .logout-btn { background: linear-gradient(135deg, #f5576c, #ff6b6b); color: white; border: none; padding: 8px 15px; border-radius: 15px; cursor: pointer; font-weight: bold; margin-left: 8px; font-family: 'Times New Roman', Times, serif; }
        
        .games-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 30px; padding: 20px; }
        .game-card { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,255,255,0.85)); border-radius: 30px; padding: 30px; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.3); transition: all 0.4s; cursor: pointer; }
        .game-card:hover { transform: translateY(-15px) scale(1.05); box-shadow: 0 30px 80px rgba(0,0,0,0.4); }
        .game-icon { font-size: 5em; margin-bottom: 20px; }
        .game-title { font-size: 2em; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 15px; font-weight: bold; }
        .game-description { font-size: 1.1em; color: #555; margin-bottom: 20px; }
        .play-btn { background: linear-gradient(135deg, #f093fb, #f5576c); color: white; border: none; padding: 15px 35px; font-size: 1.3em; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0 10px 30px rgba(245,87,108,0.5); font-family: 'Times New Roman', Times, serif; transition: all 0.3s; }
        .play-btn:hover { transform: scale(1.15); }
        
        .game-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1000; justify-content: center; align-items: center; padding: 10px; overflow-y: auto; }
        .game-content { background: #fff; border-radius: 40px; padding: 40px; max-width: 700px; width: 95%; max-height: 90vh; overflow-y: auto; box-shadow: 0 30px 90px rgba(0,0,0,0.5); position: relative; }
        .close-btn { position: absolute; top: 10px; right: 10px; background: linear-gradient(135deg, #f5576c, #ff6b6b); color: white; border: none; width: 50px; height: 50px; border-radius: 50%; font-size: 1.8em; cursor: pointer; transition: all 0.3s; }
        .close-btn:hover { transform: scale(1.1); }
        .score { font-size: 1.8em; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; margin: 20px 0; text-align: center; }
        
        .memory-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 20px 0; }
        .memory-card { aspect-ratio: 1; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 20px; display: flex; align-items: center; justify-content: center; font-size: 3em; cursor: pointer; transition: all 0.3s; }
        .memory-card.flipped { background: white; }
        
        .quiz-options { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0; }
        .quiz-option { padding: 20px; font-size: 1.5em; background: linear-gradient(135deg, #f093fb, #f5576c); color: white; border: none; border-radius: 20px; cursor: pointer; font-weight: bold; font-family: 'Times New Roman', Times, serif; transition: all 0.3s; }
        .quiz-option:hover { transform: scale(1.05); }
        
        .color-display { width: 250px; height: 250px; border-radius: 30px; margin: 20px auto; box-shadow: 0 15px 50px rgba(0,0,0,0.3); transition: all 0.5s; }
        .color-buttons { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-top: 20px; }
        .color-btn { width: 70px; height: 70px; border-radius: 50%; border: 5px solid white; cursor: pointer; box-shadow: 0 8px 25px rgba(0,0,0,0.3); transition: all 0.3s; }
        .color-btn:hover { transform: scale(1.2); }
        
        .balloon-container { height: 400px; position: relative; overflow: hidden; background: linear-gradient(to bottom, #87ceeb, #e0f6ff); border-radius: 30px; margin: 20px 0; }
        .balloon { position: absolute; width: 60px; height: 80px; border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%; cursor: pointer; animation: floatUp 6s linear; }
        
        .board-cell { aspect-ratio: 1; background: white; display: flex; align-items: center; justify-content: center; font-size: 0.9em; font-weight: bold; border-radius: 5px; position: relative; }
        .player-token { width: 20px; height: 20px; border-radius: 50%; position: absolute; border: 2px solid white; }
        .dice { width: 80px; height: 80px; background: white; border: 3px solid #333; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 2.5em; font-weight: bold; margin: 20px auto; cursor: pointer; box-shadow: 0 10px 30px rgba(0,0,0,0.3); transition: all 0.3s; }
        .dice:hover { transform: scale(1.1) rotate(5deg); }
        
        @media (max-width: 768px) {
            h1 { font-size: 2.5em; }
            .subtitle { font-size: 1.2em; }
            .games-grid { grid-template-columns: 1fr; }
            .game-content { padding: 20px; }
            .close-btn { width: 40px; height: 40px; font-size: 1.5em; }
        }
    </style>
</head>
<body>
    <div class="login-container" id="loginPage">
        <div class="login-box">
            <div class="login-logo">üéÆ</div>
            <h1 class="login-title">KidzFun Games</h1>
            <p class="login-subtitle">Welcome! Let's Play & Learn! üåü</p>
            <div class="input-group">
                <label class="input-label">üë§ Your Name:</label>
                <input type="text" id="username" class="input-field" placeholder="Enter your name..." maxlength="20">
            </div>
            <div class="input-group">
                <label class="input-label">üéÇ Your Age:</label>
                <input type="number" id="userage" class="input-field" placeholder="How old are you?" min="1" max="99">
            </div>
            <button class="login-btn" onclick="login()">Start Playing! üöÄ</button>
            <p class="welcome-text">‚ú® 18 amazing games waiting for you! ‚ú®</p>
        </div>
    </div>
    
    <div class="user-info" id="userInfo">
        <span id="userDisplay">üëã Hi!</span>
        <button class="logout-btn" onclick="logout()">Logout</button>
    </div>
    
    <div class="container" id="mainContainer">
        <header>
            <h1>üéÆ KidzFun Games üé®</h1>
            <p class="subtitle">‚ú® 18 Amazing Games to Play & Learn! ‚ú®</p>
        </header>
        <div class="games-grid">
            <div class="game-card" onclick="openGame('memory')">
                <div class="game-icon">üß†</div>
                <h2 class="game-title">Memory Cards</h2>
                <p class="game-description">Match emoji pairs!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('math')">
                <div class="game-icon">üî¢</div>
                <h2 class="game-title">Math Quiz</h2>
                <p class="game-description">Solve math problems!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('color')">
                <div class="game-icon">üé®</div>
                <h2 class="game-title">Color Mixer</h2>
                <p class="game-description">Mix beautiful colors!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('balloon')">
                <div class="game-icon">üéà</div>
                <h2 class="game-title">Balloon Pop</h2>
                <p class="game-description">Pop balloons fast!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('counting')">
                <div class="game-icon">üî¢</div>
                <h2 class="game-title">Count & Learn</h2>
                <p class="game-description">Count objects!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('alphabet')">
                <div class="game-icon">üî§</div>
                <h2 class="game-title">Alphabet Match</h2>
                <p class="game-description">Learn your ABC!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('shapes')">
                <div class="game-icon">üî∑</div>
                <h2 class="game-title">Shape Sorter</h2>
                <p class="game-description">Learn shapes!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('animals')">
                <div class="game-icon">üê∂</div>
                <h2 class="game-title">Animal Sounds</h2>
                <p class="game-description">Learn animal sounds!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('pattern')">
                <div class="game-icon">üéØ</div>
                <h2 class="game-title">Pattern Match</h2>
                <p class="game-description">Complete patterns!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('puzzle')">
                <div class="game-icon">üß©</div>
                <h2 class="game-title">Puzzle Game</h2>
                <p class="game-description">Solve the puzzle!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('tictactoe')">
                <div class="game-icon">‚ùå</div>
                <h2 class="game-title">Tic Tac Toe</h2>
                <p class="game-description">Beat the computer!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('snakeladder')">
                <div class="game-icon">üêç</div>
                <h2 class="game-title">Snake & Ladder</h2>
                <p class="game-description">Classic board game!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('ludo')">
                <div class="game-icon">üé≤</div>
                <h2 class="game-title">Ludo</h2>
                <p class="game-description">Play Ludo game!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('simon')">
                <div class="game-icon">üéµ</div>
                <h2 class="game-title">Simon Says</h2>
                <p class="game-description">Follow the pattern!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('whack')">
                <div class="game-icon">üî®</div>
                <h2 class="game-title">Whack-a-Mole</h2>
                <p class="game-description">Tap the moles!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('guess')">
                <div class="game-icon">ü§î</div>
                <h2 class="game-title">Guess Number</h2>
                <p class="game-description">Guess the number!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('catch')">
                <div class="game-icon">üçé</div>
                <h2 class="game-title">Fruit Catch</h2>
                <p class="game-description">Catch the fruits!</p>
                <button class="play-btn">Play Now!</button>
            </div>
            <div class="game-card" onclick="openGame('connect')">
                <div class="game-icon">üî¥</div>
                <h2 class="game-title">Connect Four</h2>
                <p class="game-description">Connect 4 in a row!</p>
                <button class="play-btn">Play Now!</button>
            </div>
        </div>
    </div>
    
    <div class="game-modal" id="gameModal">
        <div class="game-content">
            <button class="close-btn" onclick="closeGame()">√ó</button>
            <h2 id="gameTitle" style="color: #667eea; text-align: center; font-size: 2em; margin-bottom: 20px;"></h2>
            <div id="gameArea"></div>
        </div>
    </div>
    
    <script>
        let currentUser = {name: '', age: ''};
        let gameData = {};
        
        // Enhanced Sound Effects System
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(type) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            switch(type) {
                case 'pop': // Balloon pop
                    oscillator.type = 'sine';
                    oscillator.frequency.value = 300;
                    gainNode.gain.setValueAtTime(0.4, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
                    oscillator.start(audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 0.05);
                    oscillator.stop(audioContext.currentTime + 0.15);
                    break;
                case 'correct': // Correct answer
                    oscillator.type = 'sine';
                    oscillator.frequency.value = 523.25;
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                    oscillator.start(audioContext.currentTime);
                    oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1);
                    oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2);
                    oscillator.stop(audioContext.currentTime + 0.4);
                    break;
                case 'wrong': // Wrong answer
                    oscillator.type = 'triangle';
                    oscillator.frequency.value = 400;
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                    oscillator.start(audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.3);
                    oscillator.stop(audioContext.currentTime + 0.4);
                    break;
                case 'click': // Button click
                    oscillator.type = 'square';
                    oscillator.frequency.value = 800;
                    gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.05);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.05);
                    break;
                case 'match': // Memory card match
                    oscillator.type = 'sine';
                    oscillator.frequency.value = 659.25;
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    oscillator.start(audioContext.currentTime);
                    oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.15);
                    oscillator.frequency.setValueAtTime(1046.50, audioContext.currentTime + 0.3);
                    oscillator.stop(audioContext.currentTime + 0.5);
                    break;
                case 'flip': // Card flip
                    oscillator.type = 'sawtooth';
                    oscillator.frequency.value = 400;
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.08);
                    oscillator.start(audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(600, audioContext.currentTime + 0.08);
                    oscillator.stop(audioContext.currentTime + 0.08);
                    break;
                case 'win': // Game win
                    const notes = [523.25, 659.25, 783.99, 1046.50, 1318.51];
                    notes.forEach((freq, i) => {
                        const osc = audioContext.createOscillator();
                        const gain = audioContext.createGain();
                        osc.type = 'sine';
                        osc.connect(gain);
                        gain.connect(audioContext.destination);
                        osc.frequency.value = freq;
                        gain.gain.setValueAtTime(0.25, audioContext.currentTime + i * 0.12);
                        gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + i * 0.12 + 0.3);
                        osc.start(audioContext.currentTime + i * 0.12);
                        osc.stop(audioContext.currentTime + i * 0.12 + 0.3);
                    });
                    return;
                case 'whack': // Whack-a-mole hit
                    oscillator.type = 'triangle';
                    oscillator.frequency.value = 180;
                    gainNode.gain.setValueAtTime(0.4, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.12);
                    oscillator.start(audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(80, audioContext.currentTime + 0.08);
                    oscillator.stop(audioContext.currentTime + 0.12);
                    break;
                case 'dice': // Dice roll
                    for (let i = 0; i < 5; i++) {
                        const osc = audioContext.createOscillator();
                        const gain = audioContext.createGain();
                        osc.type = 'square';
                        osc.connect(gain);
                        gain.connect(audioContext.destination);
                        osc.frequency.value = 200 + Math.random() * 200;
                        gain.gain.setValueAtTime(0.1, audioContext.currentTime + i * 0.05);
                        gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + i * 0.05 + 0.05);
                        osc.start(audioContext.currentTime + i * 0.05);
                        osc.stop(audioContext.currentTime + i * 0.05 + 0.05);
                    }
                    return;
                case 'catch': // Fruit catch
                    oscillator.type = 'sine';
                    oscillator.frequency.value = 400;
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
                    oscillator.start(audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.1);
                    oscillator.stop(audioContext.currentTime + 0.15);
                    break;
                case 'move': // Game piece move
                    oscillator.type = 'sine';
                    oscillator.frequency.value = 300;
                    gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                    oscillator.start(audioContext.currentTime);
                    oscillator.frequency.linearRampToValueAtTime(350, audioContext.currentTime + 0.1);
                    oscillator.stop(audioContext.currentTime + 0.1);
                    break;
            }
        }
        
        function login() {
            const username = document.getElementById('username').value.trim();
            const age = document.getElementById('userage').value;
            
            if (!username) {
                alert('Please enter your name! üòä');
                return;
            }
            if (!age || age < 1) {
                alert('Please enter your age! üéÇ');
                return;
            }
            
            playSound('correct');
            currentUser = {name: username, age: age};
            
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mainContainer').classList.add('active');
            document.getElementById('userInfo').style.display = 'block';
            document.getElementById('userDisplay').textContent = `üëã Hi, ${username}!`;
        }
        
        function logout() {
            if (confirm('Do you want to logout? üëã')) {
                playSound('click');
                document.getElementById('loginPage').style.display = 'flex';
                document.getElementById('mainContainer').classList.remove('active');
                document.getElementById('userInfo').style.display = 'none';
                document.getElementById('username').value = '';
                document.getElementById('userage').value = '';
                currentUser = {name: '', age: ''};
                closeGame();
            }
        }
        
        function openGame(gameType) {
            playSound('click');
            document.getElementById('gameModal').style.display = 'flex';
            
            const games = {
                memory: {title: 'üß† Memory Cards', init: initMemoryGame},
                math: {title: 'üî¢ Math Quiz', init: initMathGame},
                color: {title: 'üé® Color Mixer', init: initColorGame},
                balloon: {title: 'üéà Balloon Pop', init: initBalloonGame},
                counting: {title: 'üî¢ Count & Learn', init: initCountingGame},
                alphabet: {title: 'üî§ Alphabet Match', init: initAlphabetGame},
                shapes: {title: 'üî∑ Shape Sorter', init: initShapesGame},
                animals: {title: 'üê∂ Animal Sounds', init: initAnimalsGame},
                pattern: {title: 'üéØ Pattern Match', init: initPatternGame},
                puzzle: {title: 'üß© Puzzle Game', init: initPuzzleGame},
                tictactoe: {title: '‚ùå Tic Tac Toe', init: initTicTacToeGame},
                snakeladder: {title: 'üêç Snake & Ladder', init: initSnakeLadderGame},
                ludo: {title: 'üé≤ Ludo', init: initLudoGame},
                simon: {title: 'üéµ Simon Says', init: initSimonGame},
                whack: {title: 'üî® Whack-a-Mole', init: initWhackGame},
                guess: {title: 'ü§î Guess Number', init: initGuessGame},
                catch: {title: 'üçé Fruit Catch', init: initCatchGame},
                connect: {title: 'üî¥ Connect Four', init: initConnectGame}
            };
            
            if (games[gameType]) {
                document.getElementById('gameTitle').textContent = games[gameType].title;
                games[gameType].init();
            }
        }
        
        function closeGame() {
            playSound('click');
            document.getElementById('gameModal').style.display = 'none';
            if (gameData.interval) clearInterval(gameData.interval);
            gameData = {};
        }
        
        function updateScore(text) {
            const scoreEl = document.querySelector('.score');
            if (scoreEl) scoreEl.textContent = text;
        }
        
        // Memory Game
        function initMemoryGame() {
            const emojis = ['üê∂','üê±','üê≠','üêπ','üê∞','ü¶ä','üêª','üêº'];
            const cards = [...emojis, ...emojis].sort(() => Math.random() - 0.5);
            gameData = {cards, flipped: [], matches: 0};
            
            let html = '<div class="score">Matches: 0/8</div><div class="memory-grid">';
            cards.forEach((emoji, i) => {
                html += `<div class="memory-card" onclick="flipMemoryCard(${i})" id="mem-${i}">‚ùì</div>`;
            });
            html += '</div>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function flipMemoryCard(index) {
            if (gameData.flipped.length >= 2) return;
            const card = document.getElementById(`mem-${index}`);
            if (card.classList.contains('flipped')) return;
            
            playSound('flip');
            card.textContent = gameData.cards[index];
            card.classList.add('flipped');
            gameData.flipped.push(index);
            
            if (gameData.flipped.length === 2) {
                setTimeout(() => {
                    const [i1, i2] = gameData.flipped;
                    if (gameData.cards[i1] === gameData.cards[i2]) {
                        playSound('match');
                        gameData.matches++;
                        updateScore(`Matches: ${gameData.matches}/8`);
                        if (gameData.matches === 8) {
                            setTimeout(() => {
                                playSound('win');
                                alert(`üéâ Amazing ${currentUser.name}! You matched all cards!`);
                            }, 300);
                        }
                    } else {
                        playSound('wrong');
                        document.getElementById(`mem-${i1}`).textContent = '‚ùì';
                        document.getElementById(`mem-${i1}`).classList.remove('flipped');
                        document.getElementById(`mem-${i2}`).textContent = '‚ùì';
                        document.getElementById(`mem-${i2}`).classList.remove('flipped');
                    }
                    gameData.flipped = [];
                }, 800);
            }
        }
        
        // Math Quiz
        function initMathGame() {
            gameData = {score: 0};
            showMathQuestion();
        }
        
        function showMathQuestion() {
            const n1 = Math.floor(Math.random() * 10) + 1;
            const n2 = Math.floor(Math.random() * 10) + 1;
            const ops = ['+', '-'];
            const op = ops[Math.floor(Math.random() * ops.length)];
            const correct = op === '+' ? n1 + n2 : Math.max(n1, n2) - Math.min(n1, n2);
            const wrong = [correct + 1, correct - 1, correct + 2].filter(a => a >= 0 && a !== correct);
            const answers = [correct, ...wrong.slice(0, 3)].sort(() => Math.random() - 0.5);
            
            gameData.correctAnswer = correct;
            
            let html = `<div class="score">Score: ${gameData.score} üåü</div>`;
            html += `<div style="font-size:2.5em;color:#667eea;margin:30px 0;font-weight:bold;text-align:center;">${Math.max(n1, n2)} ${op} ${Math.min(n1, n2)} = ?</div>`;
            html += '<div class="quiz-options">';
            answers.forEach(a => {
                html += `<button class="quiz-option" onclick="checkMathAnswer(${a})">${a}</button>`;
            });
            html += '</div>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function checkMathAnswer(selected) {
            if (selected === gameData.correctAnswer) {
                playSound('correct');
                gameData.score++;
                alert('üéâ Correct!');
                showMathQuestion();
            } else {
                playSound('wrong');
                alert('‚ùå Try again! The answer was ' + gameData.correctAnswer);
                showMathQuestion();
            }
        }
        
        // Color Mixer
        function initColorGame() {
            const colors = ['#FF6B6B','#4ECDC4','#45B7D1','#FFA07A','#98D8C8','#F7DC6F','#BB8FCE','#85C1E2'];
            let html = `<div class="color-display" id="colorDisplay" style="background:${colors[0]}"></div>`;
            html += '<div class="color-buttons">';
            colors.forEach(c => {
                html += `<button class="color-btn" style="background:${c}" onclick="changeColor('${c}')"></button>`;
            });
            html += '</div><p style="text-align:center;margin-top:20px;font-size:1.3em;color:#667eea;">‚ú® Pick your favorite colors! ‚ú®</p>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function changeColor(color) {
            playSound('click');
            document.getElementById('colorDisplay').style.background = color;
        }
        
        // Balloon Pop
        function initBalloonGame() {
            gameData = {score: 0};
            document.getElementById('gameArea').innerHTML = '<div class="score">Balloons: 0 üéà</div><div class="balloon-container" id="balloonContainer"></div>';
            gameData.interval = setInterval(createBalloon, 1200);
        }
        
        function createBalloon() {
            const colors = ['#FF6B6B','#4ECDC4','#45B7D1','#FFA07A','#98D8C8','#F7DC6F'];
            const container = document.getElementById('balloonContainer');
            if (!container) return;
            
            const balloon = document.createElement('div');
            balloon.className = 'balloon';
            balloon.style.left = Math.random() * (container.offsetWidth - 60) + 'px';
            balloon.style.background = colors[Math.floor(Math.random() * colors.length)];
            balloon.onclick = function() {
                playSound('pop');
                this.style.animation = 'none';
                this.style.transform = 'scale(0)';
                setTimeout(() => this.remove(), 200);
                gameData.score++;
                updateScore(`Balloons: ${gameData.score} üéà`);
            };
            container.appendChild(balloon);
            setTimeout(() => balloon.remove(), 6000);
        }
        
        // Counting Game
        function initCountingGame() {
            const emojis = ['üåü','üéà','üçé','üê∂','üé®'];
            const emoji = emojis[Math.floor(Math.random() * emojis.length)];
            const count = Math.floor(Math.random() * 10) + 1;
            gameData = {count, score: 0};
            
            let html = `<div class="score">Score: ${gameData.score} üåü</div>`;
            html += '<p style="text-align:center;font-size:1.5em;margin-bottom:20px;">How many?</p>';
            html += '<div style="font-size:3em;text-align:center;margin:30px;">';
            for (let i = 0; i < count; i++) html += emoji + ' ';
            html += '</div><div class="quiz-options">';
            const opts = [count, count + 1, count - 1, count + 2].filter(n => n > 0).sort(() => Math.random() - 0.5);
            opts.slice(0, 4).forEach(n => {
                html += `<button class="quiz-option" onclick="checkCount(${n})">${n}</button>`;
            });
            html += '</div>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function checkCount(answer) {
            if (answer === gameData.count) {
                playSound('correct');
                gameData.score++;
                alert('üéâ Correct!');
                initCountingGame();
            } else {
                playSound('wrong');
                alert('‚ùå Try again!');
            }
        }
        
        // Alphabet Match
        function initAlphabetGame() {
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
            const target = letters[Math.floor(Math.random() * letters.length)];
            gameData = {targetLetter: target, score: 0};
            
            let html = `<div class="score">Score: ${gameData.score} üåü</div>`;
            html += `<div style="font-size:2.5em;color:#667eea;margin:30px 0;font-weight:bold;text-align:center;">Find: ${target}</div>`;
            html += '<div class="quiz-options">';
            const opts = [target, ...letters.filter(l => l !== target).sort(() => Math.random() - 0.5).slice(0, 3)].sort(() => Math.random() - 0.5);
            opts.forEach(l => {
                html += `<button class="quiz-option" onclick="checkAlphabet('${l}')">${l}</button>`;
            });
            html += '</div>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function checkAlphabet(selected) {
            if (selected === gameData.targetLetter) {
                playSound('correct');
                gameData.score++;
                alert('üéâ Correct!');
                initAlphabetGame();
            } else {
                playSound('wrong');
                alert('‚ùå Try again!');
            }
        }
        
        // Shape Sorter
        function initShapesGame() {
            const shapes = ['üî¥ Circle', 'üü¶ Square', 'üî∫ Triangle', '‚≠ê Star'];
            const target = shapes[Math.floor(Math.random() * shapes.length)];
            gameData = {target, score: 0};
            
            let html = `<div class="score">Score: ${gameData.score} üåü</div>`;
            html += `<div style="font-size:2.5em;color:#667eea;margin:30px 0;font-weight:bold;text-align:center;">Find: ${target.split(' ')[1]}</div>`;
            html += '<div class="quiz-options">';
            shapes.sort(() => Math.random() - 0.5).forEach(s => {
                html += `<button class="quiz-option" onclick="checkShape('${s}')">${s}</button>`;
            });
            html += '</div>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function checkShape(selected) {
            if (selected === gameData.target) {
                playSound('correct');
                gameData.score++;
                alert('üéâ Correct!');
                initShapesGame();
            } else {
                playSound('wrong');
                alert('‚ùå Try again!');
            }
        }
        
        // Animal Sounds
        function initAnimalsGame() {
            const animals = [
                {name: 'Dog', emoji: 'üê∂', sound: 'Woof! Woof!'},
                {name: 'Cat', emoji: 'üê±', sound: 'Meow! Meow!'},
                {name: 'Cow', emoji: 'üêÆ', sound: 'Moo! Moo!'},
                {name: 'Pig', emoji: 'üê∑', sound: 'Oink! Oink!'},
                {name: 'Duck', emoji: 'ü¶Ü', sound: 'Quack! Quack!'},
                {name: 'Lion', emoji: 'ü¶Å', sound: 'Roar! Roar!'}
            ];
            const animal = animals[Math.floor(Math.random() * animals.length)];
            gameData = {correctAnimal: animal.name, animals, score: 0};
            
            let html = `<div class="score">Score: ${gameData.score} üåü</div>`;
            html += `<div style="font-size:2.5em;color:#667eea;margin:20px 0;font-weight:bold;text-align:center;">What sound does this make?<br>${animal.emoji}</div>`;
            html += `<p style="text-align:center;font-size:2em;margin:20px;color:#667eea;font-weight:bold;">"${animal.sound}"</p>`;
            html += '<div class="quiz-options">';
            animals.sort(() => Math.random() - 0.5).slice(0, 4).forEach(a => {
                html += `<button class="quiz-option" onclick="checkAnimal('${a.name}')">${a.emoji} ${a.name}</button>`;
            });
            html += '</div>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function checkAnimal(selected) {
            if (selected === gameData.correctAnimal) {
                playSound('correct');
                gameData.score++;
                alert('üéâ Correct!');
                initAnimalsGame();
            } else {
                playSound('wrong');
                alert('‚ùå Try again!');
            }
        }
        
        // Pattern Match
        function initPatternGame() {
            const shapes = ['üî¥','üîµ','üü¢','üü°','üü£'];
            const pattern = Array(4).fill(0).map(() => shapes[Math.floor(Math.random() * shapes.length)]);
            const correctNext = shapes[Math.floor(Math.random() * shapes.length)];
            const options = [correctNext, ...Array(2).fill(0).map(() => shapes[Math.floor(Math.random() * shapes.length)])];
            pattern.push(correctNext);
            gameData = {correctAnswer: correctNext, score: 0};
            
            let html = `<div class="score">Score: ${gameData.score} üåü</div>`;
            html += '<p style="text-align:center;font-size:1.5em;margin-bottom:20px;">Complete the pattern!</p>';
            html += '<div style="font-size:4em;text-align:center;margin:30px;">';
            pattern.forEach((s, i) => {
                if (i < pattern.length - 1) html += s + ' ';
                else html += '<span style="color:#ccc;">?</span>';
            });
            html += '</div><div class="quiz-options">';
            options.forEach(o => {
                html += `<button class="quiz-option" onclick="checkPattern('${o}')">${o}</button>`;
            });
            html += '</div>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function checkPattern(selected) {
            if (selected === gameData.correctAnswer) {
                playSound('correct');
                gameData.score++;
                alert('üéâ Correct!');
                initPatternGame();
            } else {
                playSound('wrong');
                alert('‚ùå Try again!');
            }
        }
        
        // Puzzle Game
        function initPuzzleGame() {
            const size = 3;
            const puzzle = [];
            for (let i = 0; i < size * size - 1; i++) puzzle.push(i + 1);
            puzzle.push(0);
            puzzle.sort(() => Math.random() - 0.5);
            gameData = {puzzle, size, moves: 0};
            renderPuzzle();
        }
        
        function renderPuzzle() {
            let html = `<div class="score">Moves: ${gameData.moves}</div>`;
            html += `<div style="display:grid;grid-template-columns:repeat(${gameData.size},1fr);gap:10px;max-width:400px;margin:30px auto;">`;
            gameData.puzzle.forEach((n, i) => {
                if (n === 0) {
                    html += '<div style="aspect-ratio:1;background:rgba(0,0,0,0.1);border-radius:20px;"></div>';
                } else {
                    html += `<button onclick="movePuzzlePiece(${i})" style="aspect-ratio:1;font-size:2.5em;background:linear-gradient(135deg,#667eea,#764ba2);color:white;border:none;border-radius:20px;cursor:pointer;box-shadow:0 8px 25px rgba(0,0,0,0.3);font-family:'Times New Roman',Times,serif;">${n}</button>`;
                }
            });
            html += '</div><button class="play-btn" onclick="initPuzzleGame()" style="margin:20px auto;display:block;">New Puzzle</button>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function movePuzzlePiece(index) {
            const emptyIndex = gameData.puzzle.indexOf(0);
            const validMoves = [emptyIndex - 1, emptyIndex + 1, emptyIndex - gameData.size, emptyIndex + gameData.size];
            
            if (validMoves.includes(index) && 
                !(emptyIndex % gameData.size === 0 && index === emptyIndex - 1) && 
                !(emptyIndex % gameData.size === gameData.size - 1 && index === emptyIndex + 1)) {
                playSound('move');
                [gameData.puzzle[index], gameData.puzzle[emptyIndex]] = [gameData.puzzle[emptyIndex], gameData.puzzle[index]];
                gameData.moves++;
                renderPuzzle();
                
                if (checkPuzzleSolved()) {
                    setTimeout(() => {
                        playSound('win');
                        alert(`üéâ Puzzle Solved in ${gameData.moves} moves!`);
                    }, 100);
                }
            }
        }
        
        function checkPuzzleSolved() {
            for (let i = 0; i < gameData.puzzle.length - 1; i++) {
                if (gameData.puzzle[i] !== i + 1) return false;
            }
            return gameData.puzzle[gameData.puzzle.length - 1] === 0;
        }
        
        // Tic Tac Toe
        function initTicTacToeGame() {
            gameData = {board: Array(9).fill(''), currentPlayer: 'X', gameOver: false};
            let html = '<div class="score">Your turn: X</div>';
            html += '<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;max-width:400px;margin:30px auto;">';
            for (let i = 0; i < 9; i++) {
                html += `<button onclick="makeMove(${i})" id="cell-${i}" style="aspect-ratio:1;font-size:3em;background:linear-gradient(135deg,#f093fb,#f5576c);color:white;border:none;border-radius:20px;cursor:pointer;box-shadow:0 8px 25px rgba(240,147,251,0.4);font-family:'Times New Roman',Times,serif;"></button>`;
            }
            html += '</div><button class="play-btn" onclick="initTicTacToeGame()" style="margin:20px auto;display:block;">New Game</button>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function makeMove(index) {
            if (gameData.board[index] || gameData.gameOver) return;
            
            playSound('click');
            gameData.board[index] = gameData.currentPlayer;
            document.getElementById(`cell-${index}`).textContent = gameData.currentPlayer;
            
            if (checkWinner()) {
                playSound('win');
                updateScore(`${gameData.currentPlayer} Wins! üéâ`);
                gameData.gameOver = true;
                return;
            }
            
            if (!gameData.board.includes('')) {
                updateScore('Draw! ü§ù');
                gameData.gameOver = true;
                return;
            }
            
            gameData.currentPlayer = gameData.currentPlayer === 'X' ? 'O' : 'X';
            updateScore(`Your turn: ${gameData.currentPlayer}`);
            
            if (gameData.currentPlayer === 'O' && !gameData.gameOver) {
                setTimeout(computerMove, 500);
            }
        }
        
        function computerMove() {
            const empty = gameData.board.map((v, i) => v === '' ? i : -1).filter(i => i !== -1);
            if (empty.length > 0) {
                const move = empty[Math.floor(Math.random() * empty.length)];
                makeMove(move);
            }
        }
        
        function checkWinner() {
            const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
            return wins.some(w => gameData.board[w[0]] && gameData.board[w[0]] === gameData.board[w[1]] && gameData.board[w[0]] === gameData.board[w[2]]);
        }
        
        // Snake & Ladder
        function initSnakeLadderGame() {
            gameData = {
                playerPos: 0,
                diceValue: 0,
                snakes: {16: 6, 47: 26, 49: 11, 62: 19, 87: 24, 93: 73, 95: 75, 98: 78},
                ladders: {1: 38, 4: 14, 9: 31, 21: 42, 28: 84, 51: 67, 71: 91, 80: 100}
            };
            renderSnakeLadderBoard();
        }
        
        function renderSnakeLadderBoard() {
            let html = `<div class="score">Position: ${gameData.playerPos} üéØ</div>`;
            html += '<div style="max-width:500px;margin:20px auto;"><div style="display:grid;grid-template-columns:repeat(10,1fr);gap:2px;background:#f0f0f0;padding:10px;border-radius:20px;">';
            
            for (let i = 100; i >= 1; i -= 10) {
                const row = Math.floor((100 - i) / 10);
                const start = row % 2 === 0 ? i : i - 9;
                const end = row % 2 === 0 ? i - 9 : i;
                const step = row % 2 === 0 ? -1 : 1;
                
                for (let j = start; row % 2 === 0 ? j >= end : j <= end; j += step) {
                    let cellContent = j;
                    if (gameData.snakes[j]) cellContent += ' üêç';
                    if (gameData.ladders[j]) cellContent += ' ü™ú';
                    
                    html += `<div class="board-cell">${cellContent}`;
                    if (gameData.playerPos === j) {
                        html += '<div class="player-token" style="background:#4ECDC4;top:5px;right:5px;"></div>';
                    }
                    html += '</div>';
                }
            }
            
            html += '</div></div>';
            html += `<div class="dice" onclick="rollDice()">${gameData.diceValue || 'üé≤'}</div>`;
            html += '<p style="text-align:center;font-size:1.2em;margin:10px;">Click dice to roll!</p>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function rollDice() {
            playSound('dice');
            gameData.diceValue = Math.floor(Math.random() * 6) + 1;
            let newPos = gameData.playerPos + gameData.diceValue;
            
            if (newPos <= 100) {
                gameData.playerPos = newPos;
                
                if (gameData.snakes[newPos]) {
                    setTimeout(() => {
                        playSound('wrong');
                        alert(`üêç Snake! Going down to ${gameData.snakes[newPos]}`);
                        gameData.playerPos = gameData.snakes[newPos];
                        renderSnakeLadderBoard();
                    }, 500);
                } else if (gameData.ladders[newPos]) {
                    setTimeout(() => {
                        playSound('correct');
                        alert(`ü™ú Ladder! Climbing up to ${gameData.ladders[newPos]}`);
                        gameData.playerPos = gameData.ladders[newPos];
                        renderSnakeLadderBoard();
                    }, 500);
                }
                
                if (gameData.playerPos === 100) {
                    setTimeout(() => {
                        playSound('win');
                        alert(`üéâ Congratulations ${currentUser.name}! You Won!`);
                    }, 600);
                }
            }
            renderSnakeLadderBoard();
        }
        
        // Ludo Game
        function initLudoGame() {
            gameData = {
                currentPlayer: 0,
                diceValue: 0,
                players: [
                    {color: '#FF0000', name: 'Red', position: 0},
                    {color: '#00FF00', name: 'Green', position: 0},
                    {color: '#0000FF', name: 'Blue', position: 0},
                    {color: '#FFFF00', name: 'Yellow', position: 0}
                ]
            };
            renderLudoBoard();
        }
        
        function renderLudoBoard() {
            const player = gameData.players[gameData.currentPlayer];
            let html = `<div class="score">${player.name} Player's Turn</div>`;
            html += '<div style="position:relative;width:400px;height:400px;margin:20px auto;background:white;border:5px solid #333;border-radius:20px;">';
            
            gameData.players.forEach((p, i) => {
                const angle = (i * 90) * Math.PI / 180;
                const x = 200 + Math.cos(angle) * 150;
                const y = 200 + Math.sin(angle) * 150;
                html += `<div style="position:absolute;left:${x}px;top:${y}px;width:30px;height:30px;background:${p.color};border-radius:50%;border:3px solid white;box-shadow:0 5px 15px rgba(0,0,0,0.3);"></div>`;
            });
            
            html += '</div>';
            html += `<div class="dice" onclick="rollLudoDice()">${gameData.diceValue || 'üé≤'}</div>`;
            html += '<p style="text-align:center;font-size:1.2em;margin:10px;">Click dice to roll and move!</p>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function rollLudoDice() {
            playSound('dice');
            gameData.diceValue = Math.floor(Math.random() * 6) + 1;
            const player = gameData.players[gameData.currentPlayer];
            player.position += gameData.diceValue;
            
            if (player.position >= 100) {
                playSound('win');
                alert(`üéâ ${player.name} player wins!`);
                return;
            }
            
            gameData.currentPlayer = (gameData.currentPlayer + 1) % 4;
            renderLudoBoard();
        }
        
        // Simon Says
        function initSimonGame() {
            gameData = {sequence: [], userSequence: [], round: 0};
            let html = '<div class="score">Round: 0</div>';
            html += '<p style="text-align:center;margin:20px;font-size:1.2em;">Watch and repeat the pattern!</p>';
            html += '<div style="display:grid;grid-template-columns:repeat(2,1fr);gap:20px;max-width:400px;margin:30px auto;">';
            html += '<div id="simon-0" onclick="simonClick(0)" style="aspect-ratio:1;background:#FF6B6B;border-radius:20px;cursor:pointer;box-shadow:0 10px 30px rgba(0,0,0,0.3);"></div>';
            html += '<div id="simon-1" onclick="simonClick(1)" style="aspect-ratio:1;background:#4ECDC4;border-radius:20px;cursor:pointer;box-shadow:0 10px 30px rgba(0,0,0,0.3);"></div>';
            html += '<div id="simon-2" onclick="simonClick(2)" style="aspect-ratio:1;background:#F7DC6F;border-radius:20px;cursor:pointer;box-shadow:0 10px 30px rgba(0,0,0,0.3);"></div>';
            html += '<div id="simon-3" onclick="simonClick(3)" style="aspect-ratio:1;background:#BB8FCE;border-radius:20px;cursor:pointer;box-shadow:0 10px 30px rgba(0,0,0,0.3);"></div>';
            html += '</div>';
            html += '<button class="play-btn" onclick="startSimon()" style="margin:20px auto;display:block;">Start Game</button>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function startSimon() {
            playSound('click');
            gameData.sequence.push(Math.floor(Math.random() * 4));
            gameData.userSequence = [];
            gameData.round++;
            updateScore(`Round: ${gameData.round}`);
            playSimonSequence();
        }
        
        function playSimonSequence() {
            gameData.sequence.forEach((btn, i) => {
                setTimeout(() => {
                    const el = document.getElementById(`simon-${btn}`);
                    if (el) {
                        playSound('click');
                        el.style.filter = 'brightness(1.8)';
                        setTimeout(() => el.style.filter = 'brightness(1)', 300);
                    }
                }, i * 600);
            });
        }
        
        function simonClick(index) {
            playSound('click');
            const el = document.getElementById(`simon-${index}`);
            el.style.filter = 'brightness(1.8)';
            setTimeout(() => el.style.filter = 'brightness(1)', 200);
            
            gameData.userSequence.push(index);
            
            if (gameData.userSequence[gameData.userSequence.length - 1] !== gameData.sequence[gameData.userSequence.length - 1]) {
                playSound('wrong');
                alert('‚ùå Wrong! Game Over!');
                gameData = {sequence: [], userSequence: [], round: 0};
                updateScore('Round: 0');
                return;
            }
            
            if (gameData.userSequence.length === gameData.sequence.length) {
                playSound('correct');
                setTimeout(startSimon, 1000);
            }
        }
        
        // Whack-a-Mole
        function initWhackGame() {
            gameData = {score: 0, moles: [], gameActive: true};
            let html = '<div class="score">Score: 0 üî®</div>';
            html += '<p style="text-align:center;margin:20px;font-size:1.2em;">Whack the moles!</p>';
            html += '<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin:30px auto;max-width:400px;" id="moleGrid"></div>';
            document.getElementById('gameArea').innerHTML = html;
            
            const grid = document.getElementById('moleGrid');
            for (let i = 0; i < 9; i++) {
                const hole = document.createElement('div');
                hole.style.cssText = 'aspect-ratio:1;background:#8B4513;border-radius:50%;position:relative;cursor:pointer;box-shadow:inset 0 10px 20px rgba(0,0,0,0.5);';
                hole.innerHTML = '<div class="mole" style="position:absolute;bottom:-50px;left:50%;transform:translateX(-50%);font-size:3em;transition:bottom 0.3s;">üêπ</div>';
                hole.onclick = () => whackMole(i);
                grid.appendChild(hole);
                gameData.moles.push({element: hole.querySelector('.mole'), visible: false});
            }
            gameData.interval = setInterval(showMole, 800);
        }
        
        function showMole() {
            if (!gameData.gameActive) return;
            const available = gameData.moles.filter(m => !m.visible);
            if (available.length > 0) {
                const mole = available[Math.floor(Math.random() * available.length)];
                mole.visible = true;
                mole.element.style.bottom = '10px';
                setTimeout(() => {
                    if (mole.visible) {
                        mole.visible = false;
                        mole.element.style.bottom = '-50px';
                    }
                }, 1500);
            }
        }
        
        function whackMole(index) {
            if (gameData.moles[index].visible) {
                playSound('whack');
                gameData.moles[index].visible = false;
                gameData.moles[index].element.style.bottom = '-50px';
                gameData.score++;
                updateScore(`Score: ${gameData.score} üî®`);
            }
        }
        
        // Guess Number
        function initGuessGame() {
            const target = Math.floor(Math.random() * 100) + 1;
            gameData = {target, attempts: 0, maxAttempts: 7};
            
            let html = '<div class="score">Guess the number (1-100)</div>';
            html += '<p style="text-align:center;margin:20px;font-size:1.2em;">I\'m thinking of a number between 1 and 100!</p>';
            html += '<input type="number" id="guessInput" min="1" max="100" style="width:100%;padding:15px;font-size:1.5em;border:3px solid #667eea;border-radius:20px;text-align:center;margin:20px 0;font-family:\'Times New Roman\',Times,serif;">';
            html += '<button class="play-btn" onclick="makeGuess()" style="margin:10px auto;display:block;">Make Guess</button>';
            html += '<div id="guessHint" style="text-align:center;font-size:1.3em;color:#667eea;margin-top:20px;"></div>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function makeGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            if (!guess || guess < 1 || guess > 100) {
                alert('Please enter a number between 1 and 100!');
                return;
            }
            
            gameData.attempts++;
            const hint = document.getElementById('guessHint');
            
            if (guess === gameData.target) {
                playSound('win');
                alert(`üéâ Correct! You found it in ${gameData.attempts} attempts!`);
                initGuessGame();
            } else if (gameData.attempts >= gameData.maxAttempts) {
                playSound('wrong');
                alert(`‚ùå Game Over! The number was ${gameData.target}`);
                initGuessGame();
            } else {
                playSound('click');
                if (guess < gameData.target) {
                    hint.textContent = `üìà Higher! Attempts: ${gameData.attempts}/${gameData.maxAttempts}`;
                } else {
                    hint.textContent = `üìâ Lower! Attempts: ${gameData.attempts}/${gameData.maxAttempts}`;
                }
            }
        }
        
        // Fruit Catch
        function initCatchGame() {
            gameData = {score: 0, basketX: 200};
            let html = '<div class="score">Score: 0 üçé</div>';
            html += '<div style="position:relative;width:400px;height:400px;margin:20px auto;background:linear-gradient(to bottom,#87ceeb,#90EE90);border-radius:20px;overflow:hidden;" id="catchArea">';
            html += '<div id="basket" style="position:absolute;bottom:10px;left:200px;width:80px;height:50px;background:#8B4513;border-radius:10px;"></div>';
            html += '</div>';
            html += '<div style="text-align:center;margin:20px;"><button class="play-btn" onclick="moveBasket(-20)">‚óÄ Left</button> <button class="play-btn" onclick="moveBasket(20)">Right ‚ñ∂</button></div>';
            document.getElementById('gameArea').innerHTML = html;
            gameData.interval = setInterval(dropFruit, 2000);
        }
        
        function moveBasket(dx) {
            playSound('move');
            gameData.basketX = Math.max(0, Math.min(320, gameData.basketX + dx));
            const basket = document.getElementById('basket');
            if (basket) basket.style.left = gameData.basketX + 'px';
        }
        
        function dropFruit() {
            const fruits = ['üçé','üçä','üçå','üçá','üçì'];
            const catchArea = document.getElementById('catchArea');
            if (!catchArea) return;
            
            const fruit = document.createElement('div');
            fruit.textContent = fruits[Math.floor(Math.random() * fruits.length)];
            fruit.style.cssText = `position:absolute;top:0;left:${Math.random()*360}px;font-size:2em;`;
            catchArea.appendChild(fruit);
            
            let top = 0;
            const fall = setInterval(() => {
                top += 5;
                fruit.style.top = top + 'px';
                
                if (top > 350) {
                    const fruitX = parseInt(fruit.style.left);
                    if (fruitX >= gameData.basketX && fruitX <= gameData.basketX + 80) {
                        playSound('catch');
                        gameData.score++;
                        updateScore(`Score: ${gameData.score} üçé`);
                    }
                    clearInterval(fall);
                    fruit.remove();
                }
            }, 50);
        }
        
        // Connect Four
        function initConnectGame() {
            gameData = {
                board: Array(6).fill(null).map(() => Array(7).fill('')),
                currentPlayer: 'X',
                gameOver: false
            };
            renderConnectBoard();
        }
        
        function renderConnectBoard() {
            let html = '<div class="score">Player: ' + (gameData.currentPlayer === 'X' ? 'üî¥' : 'üü°') + '</div>';
            html += '<div style="background:#0066cc;padding:20px;border-radius:20px;max-width:500px;margin:20px auto;">';
            html += '<div style="display:grid;grid-template-columns:repeat(7,1fr);gap:10px;">';
            
            for (let col = 0; col < 7; col++) {
                html += `<button onclick="dropConnectPiece(${col})" style="padding:10px;background:#4ECDC4;border:none;border-radius:10px;cursor:pointer;font-size:1.2em;font-family:'Times New Roman',Times,serif;">Drop</button>`;
            }
            
            html += '</div><div style="display:grid;grid-template-rows:repeat(6,1fr);gap:8px;margin-top:10px;">';
            
            for (let row = 0; row < 6; row++) {
                html += '<div style="display:grid;grid-template-columns:repeat(7,1fr);gap:8px;">';
                for (let col = 0; col < 7; col++) {
                    const cell = gameData.board[row][col];
                    const color = cell === 'X' ? 'üî¥' : cell === 'O' ? 'üü°' : '‚ö™';
                    html += `<div style="aspect-ratio:1;background:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:2em;">${color}</div>`;
                }
                html += '</div>';
            }
            
            html += '</div></div>';
            html += '<button class="play-btn" onclick="initConnectGame()" style="margin:20px auto;display:block;">New Game</button>';
            document.getElementById('gameArea').innerHTML = html;
        }
        
        function dropConnectPiece(col) {
            if (gameData.gameOver) return;
            
            for (let row = 5; row >= 0; row--) {
                if (gameData.board[row][col] === '') {
                    playSound('click');
                    gameData.board[row][col] = gameData.currentPlayer;
                    renderConnectBoard();
                    
                    if (checkConnectWin(row, col)) {
                        setTimeout(() => {
                            playSound('win');
                            alert(`üéâ ${gameData.currentPlayer === 'X' ? 'Red' : 'Yellow'} wins!`);
                            gameData.gameOver = true;
                        }, 100);
                        return;
                    }
                    
                    gameData.currentPlayer = gameData.currentPlayer === 'X' ? 'O' : 'X';
                    renderConnectBoard();
                    return;
                }
            }
        }
        
        function checkConnectWin(row, col) {
            const player = gameData.board[row][col];
            
            // Check horizontal
            let count = 1;
            for (let c = col - 1; c >= 0 && gameData.board[row][c] === player; c--) count++;
            for (let c = col + 1; c < 7 && gameData.board[row][c] === player; c++) count++;
            if (count >= 4) return true;
            
            // Check vertical
            count = 1;
            for (let r = row - 1; r >= 0 && gameData.board[r][col] === player; r--) count++;
            for (let r = row + 1; r < 6 && gameData.board[r][col] === player; r++) count++;
            if (count >= 4) return true;
            
            // Check diagonal
            count = 1;
            for (let i = 1; row - i >= 0 && col - i >= 0 && gameData.board[row - i][col - i] === player; i++) count++;
            for (let i = 1; row + i < 6 && col + i < 7 && gameData.board[row + i][col + i] === player; i++) count++;
            if (count >= 4) return true;
            
            count = 1;
            for (let i = 1; row - i >= 0 && col + i < 7 && gameData.board[row - i][col + i] === player; i++) count++;
            for (let i = 1; row + i < 6 && col - i >= 0 && gameData.board[row + i][col - i] === player; i++) count++;
            if (count >= 4) return true;
            
            return false;
        }
    </script>
</body>
</html>